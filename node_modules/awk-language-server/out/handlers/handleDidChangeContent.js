"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDidChangeContentHandler = void 0;
const analyze_1 = require("../analyze");
const validate_1 = require("../validation/validate");
function getDidChangeContentHandler(context) {
    const { trees, symbols, namespaces, dependencies, docs } = context;
    return function handleDidChangeContent(change) {
        const results = analyze_1.analyze(context, change.document, docs);
        trees[change.document.uri] = results.tree;
        symbols[change.document.uri] = results.symbols;
        namespaces[change.document.uri] = results.namespaces;
        dependencies.update(change.document.uri, new Set(results.dependencyUris));
        const diagnostics = validate_1.validate(results.tree, symbols, namespaces, dependencies, change.document.uri, docs);
        context.connection.sendDiagnostics({ uri: change.document.uri, diagnostics });
    };
}
exports.getDidChangeContentHandler = getDidChangeContentHandler;
//# sourceMappingURL=handleDidChangeContent.js.map